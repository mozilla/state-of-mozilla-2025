---
import { Image } from "astro:assets";
import Layout from "../layouts/Layout.astro";
import Captcha from "../components/Captcha.svelte";
import Svg from "../components/Svg.svelte";
import ProgressWatcher from "../components/ProgressWatcher.svelte";
import ProgressCard from "../components/ProgressCard.svelte";
import dotsBig from "../assets/img/dots-big.png";
import videoPoster2 from "../assets/img/video-poster-2.jpg";
import videoPoster3 from "../assets/img/video-poster-3.jpg";
---

<script is:inline>
  // Restore selection immediately before DOM renders to prevent flicker
  (function () {
    var stored = localStorage.getItem("stakesSelection");
    if (stored === "a") {
      document.documentElement.classList.add("stakes-a");
    } else if (stored === "b") {
      document.documentElement.classList.add("stakes-b");
    }
  })();
</script>

<Layout>
  <Captcha client:load />

  <section class="relative p-2.5 lg:p-5 min-h-[50vh] bg-yellow overflow-hidden">
    <Image
      priority
      class="absolute bottom-0 left-0 right-0 lg:translate-y-1/2"
      src={dotsBig}
      alt=""
    />
    <div
      class="absolute max-lg:w-1/2 right-2.5 lg:right-5 bottom-2.5 lg:bottom-5"
    >
      <Svg client:load src="/svg/stakes.svg" class="w-full h-full" />
    </div>
    <div class="relative lg:w-3/4 space-y-2.5 lg:space-y-5">
      <p>I - The Stakes</p>
      <h1 class="text-6xl lg:text-9xl uppercase">Closed vs. Open</h1>
    </div>
  </section>

  <section class="p-2.5 lg:p-5">
    <div class="grid lg:grid-cols-4 gap-2.5 lg:gap-5">
      <div class="lg:col-span-2 lg:col-start-2 space-y-2.5 lg:space-y-5">
        <p>
          AI isn't just another tech trend. It’s become the beating heart of
          most apps, tools and technology we use today. We're gaining incredible
          capabilities: natural language interaction with computers, automation
          of mundane tasks, creative collaboration tools, and accessibility
          breakthroughs that were impossible just years ago.
        </p>
        <p>
          But as much promise as these innovations hold, we’re at a crossroads.
          Will this technology benefit everyone? Or will it be exploited and
          centrally controlled? Will AI be great, and give us the delightful and
          transformational experiences we’re hoping for? Or will it be a
          terrible, extractive or even dangerous pile of slop? Right now it's
          both, but the ultimate direction it takes is still up to us.
        </p>
        <p>
          <strong>
            What if a rebel alliance of sorts — developers, activists,
            researchers, founders, investors — joined forces to build something
            different? What if we proved that a different model could win?
          </strong>
          It wasn't just idealism that broke Microsoft's stranglehold over the web
          —it was innovation; experimentation; participation; and a rebel alliance
          of programmers, developers, activists, investors and coders who built something
          new, together.
        </p>
        <p><em>It’s up to us to decide.</em></p>
      </div>
    </div>
  </section>

  <section class="p-2.5 lg:p-5 space-y-2.5 lg:space-y-5">
    <div class="marquee bg-blue text-white text-xl -mx-2.5 lg:-mx-5">
      <ul class="marquee__content">
        <li>DO NOT ACCEPT DEFAULT SETTINGS</li>
        <li>DO NOT ACCEPT DEFAULT SETTINGS</li>
        <li>DO NOT ACCEPT DEFAULT SETTINGS</li>
        <li>DO NOT ACCEPT DEFAULT SETTINGS</li>
        <li>DO NOT ACCEPT DEFAULT SETTINGS</li>
        <li>DO NOT ACCEPT DEFAULT SETTINGS</li>
      </ul>
      <ul aria-hidden="true" class="marquee__content">
        <li>DO NOT ACCEPT DEFAULT SETTINGS</li>
        <li>DO NOT ACCEPT DEFAULT SETTINGS</li>
        <li>DO NOT ACCEPT DEFAULT SETTINGS</li>
        <li>DO NOT ACCEPT DEFAULT SETTINGS</li>
        <li>DO NOT ACCEPT DEFAULT SETTINGS</li>
        <li>DO NOT ACCEPT DEFAULT SETTINGS</li>
      </ul>
    </div>
    <p class="text-center border-y border-black py-2.5">TWO FUTURES</p>
    <div class="grid grid-cols-2 lg:gap-2.5">
      <div class="space-y-2.5 lg:space-y-5">
        <button
          data-selection="a"
          class="future-toggle future-toggle-a relative aspect-video w-full flex justify-center items-center outline outline-dashed cursor-pointer bg-yellow hover:bg-black hover:text-yellow"
        >
          <div class="absolute inset-0 w-full h-full overflow-hidden">
            <Svg
              client:load
              src="/svg/dots.svg"
              class="absolute left-0 right-0 bottom-0 w-full object-cover"
            />
          </div>
          <span class="text-9xl">A</span>
        </button>
      </div>
      <div class="space-y-2.5 lg:space-y-5">
        <button
          data-selection="b"
          class="future-toggle future-toggle-b relative aspect-video w-full flex justify-center items-center outline outline-dashed cursor-pointer bg-yellow hover:bg-black hover:text-yellow"
        >
          <div class="absolute inset-0 w-full h-full overflow-hidden">
            <Svg
              client:load
              src="/svg/dots.svg"
              class="absolute left-0 right-0 bottom-0 w-full object-cover"
            />
          </div>
          <span class="text-9xl">B</span>
        </button>
      </div>
    </div>
    <div class="grid lg:grid-cols-2 lg:gap-2.5">
      <div class="future-a space-y-2.5 lg:space-y-5 lg:col-start-1">
        <Image
          src={videoPoster2}
          class="aspect-[4/3] object-cover w-full"
          alt="BLACKBOX"
        />

        <p>
          Twenty five years ago, when Microsoft controlled 95% of browsers, they
          defined how people accessed information, who could build what, and on
          what terms. Mozilla was born to end that stranglehold, challenging
          other browsers dominance and shocking the world when we won the fight
          to guard the open nature of the internet. That remains our north star
          today.
        </p>
        <p>
          Today's AI concentration is far more insidious. Right now, a few big
          companies are vying for control of the full stack that will underpin
          our shared future —hardware, software, data, energy, and
          infrastructure. This isn't just about market share, it's about who
          decides how billions of people learn, create and see the world.
        </p>
        <p>
          We’re excited about the possibilities that AI offers. But too often
          the AI we’re getting watches and controls, and just isn’t that useful.
        </p>
        <p><em>Is this the future you want?</em></p>
      </div>
      <div class="future-b space-y-2.5 lg:space-y-5 lg:col-start-2">
        <Image
          src={videoPoster3}
          class="aspect-[4/3] object-cover w-full"
          alt="BRAINFRUIT"
        />

        <p>Imagine it’s 2030.</p>
        <p>
          You wake up and your digital world feels different — familiar, but
          freer. The tools you use don’t watch you; they work for you. AI agents
          collaborate, not control. The web is alive again — open, creative,
          participatory — a space where people and ideas, not monopolies, shape
          what comes next.
        </p>
        <p>
          AI isn’t something that happens to us anymore. It’s something we shape
          — in our work, our community, our daily lives. Independent creators
          are thriving. Local entrepreneurs and small nonprofits are using
          open-source models to build solutions that actually fit their needs.
          Students are learning with AI that reflects their culture and
          language. Researchers are collaborating across borders on systems that
          are transparent, ethical, and free.
        </p>
        <p>
          Twenty-five years ago, the global open source community rewrote the
          rules of the internet. Mozilla was a part of this.Together, we proved
          that an open, values-driven approach to technology could win — not
          just morally, but in the marketplace. We can do it again for AI.
        </p>
        <p>
          <em>How can we build this future together?</em>
        </p>
      </div>
    </div>
  </section>

  <ProgressWatcher
    client:load
    current="stakes"
    number="one"
    position="first"
    next="manifesto"
    text="> Make a choice to unlock stamp..."
  />

  <ProgressCard client:load full={false} />
</Layout>

<style>
  /* Default state: content hidden */
  .future-a,
  .future-b,
  .future-section {
    display: none;
  }

  /* When A is selected */
  html.stakes-a .future-toggle-a {
    background-color: #000;
    color: var(--color-yellow);
  }
  html.stakes-a .future-a,
  html.stakes-a .future-section {
    display: block;
  }

  /* When B is selected */
  html.stakes-b .future-toggle-b {
    background-color: #000;
    color: var(--color-yellow);
  }
  html.stakes-b .future-b,
  html.stakes-b .future-section {
    display: block;
  }
</style>

<script is:inline>
  // Handle click events for A/B selection
  document.addEventListener("click", function (event) {
    var toggleElement = event.target.closest(".future-toggle");
    if (!toggleElement) return;

    var selection = toggleElement.dataset.selection;
    if (!selection) return;

    var html = document.documentElement;
    var currentClass = "stakes-" + selection;
    var isActive = html.classList.contains(currentClass);

    // Remove both classes first
    html.classList.remove("stakes-a", "stakes-b");

    if (isActive) {
      // Deselect - remove from localStorage
      localStorage.removeItem("stakesSelection");
    } else {
      // Select - add class and save to localStorage
      html.classList.add(currentClass);
      localStorage.setItem("stakesSelection", selection);
    }
  });
</script>
