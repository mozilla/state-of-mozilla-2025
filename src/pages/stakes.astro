---
import { Image } from "astro:assets";
import Layout from "../layouts/Layout.astro";
// import Captcha from "../components/Captcha.svelte";
import Svg from "../components/Svg.svelte";
// import ProgressWatcher from "../components/ProgressWatcher.svelte";
import dotsBig from "../assets/img/dots-big.png";
import Video from "../components/Video.svelte";
---

<script is:inline>
  // Restore selection immediately before DOM renders to prevent flicker
  (function () {
    var stored = localStorage.getItem("stakesSelection");
    if (stored === "a") {
      document.documentElement.classList.add("stakes-a");
    } else if (stored === "b") {
      document.documentElement.classList.add("stakes-b");
    }
  })();
</script>

<Layout>
  <!-- <Captcha client:load /> -->

  <section class="relative p-2.5 lg:p-5 min-h-[50vh] bg-yellow overflow-hidden">
    <Image
      priority
      class="absolute bottom-0 left-0 right-0 lg:translate-y-1/2"
      src={dotsBig}
      alt=""
    />
    <div
      class="absolute w-1/2 lg:w-1/4 right-2.5 lg:right-5 bottom-2.5 lg:bottom-5"
    >
      <Svg client:load src="/svg/icon-stakes.svg" class="w-full h-full" />
    </div>
    <div class="relative lg:w-3/4 space-y-2.5 lg:space-y-5">
      <h1 class="font-tuoi-tre text-6xl lg:text-9xl">
        Which &#x0066;uture will you choose?
      </h1>
    </div>
  </section>

  <section class="p-2.5 lg:p-5">
    <div class="grid lg:grid-cols-4 gap-2.5 lg:gap-5">
      <div class="lg:col-span-2 lg:col-start-2 space-y-2.5 lg:space-y-5">
        <p>
          The choice we face is stark: the wrong direction for AI is a threat to
          the web and humanity. A better version of AI helps the web, and helps
          humanity.
        </p>
        <p>
          <strong
            >What if a rebel alliance of sorts — developers, activists,
            researchers, founders, investors — joined forces to build something
            different? What if we proved that a different model could win?</strong
          > It wasn't just idealism that broke Microsoft's stranglehold over the web
          —it was innovation; experimentation; participation; and a rebel alliance
          of programmers, developers, activists, investors and coders who built something
          new, together.
        </p>
        <p><em>It’s up to us to decide.</em></p>
      </div>
    </div>
  </section>

  <section class="p-2.5 lg:p-5 space-y-2.5 lg:space-y-5">
    <div class="marquee bg-black text-white text-xl -mx-2.5 lg:-mx-5">
      <ul class="marquee__content">
        <li>DO NOT ACCEPT DEFAULT SETTINGS</li>
        <li>DO NOT ACCEPT DEFAULT SETTINGS</li>
        <li>DO NOT ACCEPT DEFAULT SETTINGS</li>
        <li>DO NOT ACCEPT DEFAULT SETTINGS</li>
        <li>DO NOT ACCEPT DEFAULT SETTINGS</li>
        <li>DO NOT ACCEPT DEFAULT SETTINGS</li>
      </ul>
      <ul aria-hidden="true" class="marquee__content">
        <li>DO NOT ACCEPT DEFAULT SETTINGS</li>
        <li>DO NOT ACCEPT DEFAULT SETTINGS</li>
        <li>DO NOT ACCEPT DEFAULT SETTINGS</li>
        <li>DO NOT ACCEPT DEFAULT SETTINGS</li>
        <li>DO NOT ACCEPT DEFAULT SETTINGS</li>
        <li>DO NOT ACCEPT DEFAULT SETTINGS</li>
      </ul>
    </div>
    <p class="text-center border-y border-black py-2.5">TWO FUTURES</p>
    <div class="grid grid-cols-2 lg:gap-2.5">
      <div class="space-y-2.5 lg:space-y-5">
        <button
          data-selection="a"
          class="future-toggle future-toggle-a relative aspect-video w-full flex justify-center items-center outline outline-dashed cursor-pointer bg-yellow hover:bg-black hover:text-yellow"
        >
          <div class="absolute inset-0 w-full h-full overflow-hidden">
            <Svg
              client:load
              src="/svg/dots.svg"
              class="absolute left-0 right-0 bottom-0 w-full object-cover"
            />
          </div>
          <span class="text-9xl">A</span>
        </button>
      </div>
      <div class="space-y-2.5 lg:space-y-5">
        <button
          data-selection="b"
          class="future-toggle future-toggle-b relative aspect-video w-full flex justify-center items-center outline outline-dashed cursor-pointer bg-yellow hover:bg-black hover:text-yellow"
        >
          <div class="absolute inset-0 w-full h-full overflow-hidden">
            <Svg
              client:load
              src="/svg/dots.svg"
              class="absolute left-0 right-0 bottom-0 w-full object-cover"
            />
          </div>
          <span class="text-9xl">B</span>
        </button>
      </div>
    </div>
    <div class="grid lg:grid-cols-2 lg:gap-2.5">
      <div class="future-a space-y-2.5 lg:space-y-5 lg:col-start-1">
        <div>
          <Video
            client:load
            src="https://player.vimeo.com/progressive_redirect/playback/1156588170/rendition/1080p/file.mp4%20%281080p%29.mp4?loc=external&signature=3923e953c2d233dde973281d097dc5a4ac50630b4674118c9616b40b50e7081d"
          />
        </div>

        <p>
          Twenty five years ago, when Microsoft controlled 95% of browsers, they
          defined how people accessed information, who could build what, and on
          what terms. Mozilla was born to end that stranglehold, challenging
          other browsers dominance and shocking the world when we won the fight
          to guard the open nature of the internet. That remains our north star
          today.
        </p>
        <p>
          Today's AI concentration is far more insidious. Right now, a few big
          companies are vying for control of the full stack that will underpin
          our shared future —hardware, software, data, energy, and
          infrastructure. This isn't just about market share, it's about who
          decides how billions of people learn, create and see the world.
        </p>
        <p>
          We’re excited about some of the possibilities that AI offers. But too
          often we’re just getting AI that watches and controls.
        </p>
        <p><em>Is this the future you want?</em></p>
      </div>
      <div class="future-b space-y-2.5 lg:space-y-5 lg:col-start-2">
        <div>
          <Video
            client:load
            src="https://player.vimeo.com/progressive_redirect/playback/1156586578/rendition/1080p/file.mp4%20%281080p%29.mp4?loc=external&signature=f8382c1e4d1715cb5b65a825619a7be8b8c8bb6997ec0eb136829e534a499d78"
          />
        </div>

        <p>Imagine it’s 2030.</p>
        <p>
          You wake up and your digital world feels different — familiar, but
          freer. The tools you use don’t watch you; they work for you. AI agents
          collaborate, not control. The web is alive again — open, creative,
          participatory — a space where people and ideas, not monopolies, shape
          what comes next.
        </p>
        <p>
          AI isn’t something that happens to us anymore. It’s something we shape
          — in our work, our community, our daily lives. Independent creators
          are thriving. Local entrepreneurs and small nonprofits are using
          open-source models to build solutions that actually fit their needs.
          Students are learning with AI that reflects their culture and
          language. Researchers are collaborating across borders on systems that
          are transparent, ethical, and free.
        </p>
        <p>
          Twenty-five years ago, the global open source community rewrote the
          rules of the internet. Mozilla was a part of this.Together, we proved
          that an open, values-driven approach to technology could win — not
          just morally, but in the marketplace. We can do it again for AI.
        </p>
        <p>
          <em>How can we build this future together?</em>
        </p>
      </div>
    </div>
  </section>

  <section class="px-2.5 lg:px-5">
    <div class="grid lg:grid-cols-3 lg:gap-2.5">
      <div class="lg:col-start-2">
        <a
          class="group flex flex-col gap-px bg-yellow text-black hover:bg-black hover:text-white outline outline-dashed outline-black divide-y divide-dashed"
          href="/manifesto"
        >
          <div>
            <div class="p-2.5 p-5 space-y-2.5">
              <p class="uppercase">Go to next chapter</p>
              <h3
                class="text-5xl lg:text-xl xl:text-2xl 2xl:text-3xl uppercase"
              >
                Manifesto
              </h3>
            </div>
            <div class="relative overflow-hidden h-10 lg:h-20 -mt-10">
              <Svg
                client:load
                src="/svg/dots.svg"
                class="absolute left-0 right-0 top-1/2 -translate-y-1/2 w-full object-cover"
              />
            </div>
          </div>
          <div class="p-2.5">PROCEED →</div>
        </a>
      </div>
    </div>
  </section>

  <!-- <ProgressWatcher
    client:load
    current="stakes"
    number="one"
    n="1"
    position="first"
    next="manifesto"
    text="> Make a choice to unlock stamp..."
  /> -->
</Layout>

<style>
  /* Default state: content hidden */
  .future-a,
  .future-b,
  .future-section {
    display: none;
  }

  /* When A is selected */
  html.stakes-a .future-toggle-a {
    background-color: #000;
    color: var(--color-yellow);
  }
  html.stakes-a .future-a,
  html.stakes-a .future-section {
    display: block;
  }

  /* When B is selected */
  html.stakes-b .future-toggle-b {
    background-color: #000;
    color: var(--color-yellow);
  }
  html.stakes-b .future-b,
  html.stakes-b .future-section {
    display: block;
  }
</style>

<script is:inline>
  // Handle click events for A/B selection
  document.addEventListener("click", function (event) {
    var toggleElement = event.target.closest(".future-toggle");
    if (!toggleElement) return;

    var selection = toggleElement.dataset.selection;
    if (!selection) return;

    var html = document.documentElement;
    var currentClass = "stakes-" + selection;
    var isActive = html.classList.contains(currentClass);

    // Remove both classes first
    html.classList.remove("stakes-a", "stakes-b");

    if (isActive) {
      // Deselect - remove from localStorage
      localStorage.removeItem("stakesSelection");
    } else {
      // Select - add class and save to localStorage
      html.classList.add(currentClass);
      localStorage.setItem("stakesSelection", selection);
    }
  });
</script>
