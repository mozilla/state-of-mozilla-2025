---
import "../styles/global.css";
import IntroWrapper from "../components/IntroWrapper.svelte";
import Header from "../components/Header.svelte";
import Footer from "../components/Footer.svelte";

// Normalize pathname by removing trailing slash, but keep "/" for root
const normalizedPath =
  Astro.url.pathname === "/" ? "/" : Astro.url.pathname.replace(/\/$/, "");
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <link
      rel="apple-touch-icon"
      type="image/png"
      sizes="180x180"
      href="/apple-touch-icon.05aa000f6748.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="196x196"
      href="/favicon-196x196.e143075360ea.png"
    />
    <link rel="shortcut icon" href="/favicon.d0be64e474b1.ico" />
    <meta name="generator" content={Astro.generator} />
    <title>State of Mozilla 2025</title>
  </head>
  <body class="flex flex-col min-h-svh">
    <Header currentPage={normalizedPath} client:load />
    <IntroWrapper client:load>
      <main class="space-y-10 lg:space-y-20">
        <slot />
      </main>
      <Footer />
    </IntroWrapper>
    <script is:inline>
      if (sessionStorage.getItem("introShown")) {
        document.documentElement.classList.add("intro-seen");
      }
      if (sessionStorage.getItem("captchaVerified")) {
        document.documentElement.classList.add("captcha-seen");
      }
    </script>
  </body>
</html>
